# ML model to detect anomalies
import tensorflow as tf

anomaly_model = tf.keras.models.load_model('anomaly_detector.h5')


def detect_anomalies(file_bytes):
    # Preprocess file bytes
    # Make prediction with model
    # Return anomalies score
    
# Static analysis
import androguard
from androguard.core.bytecodes import apk

def static_analysis(file_bytes):
    a = apk.APK(file_bytes) 
    d = a.get_android_manifest_axml().get_xml_obj()
    
    # Analyze manifest, bytecode etc
    # Return detected issues
    
# Dynamic analysis
from androx.client import Client

def dynamic_analysis(file_path):
    with Client() as client:
        issues = client.analyze_apk(file_path)
        
    # Return detected runtime issues